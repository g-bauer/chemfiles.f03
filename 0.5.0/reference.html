<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fortran interface reference &mdash; Fortran interface to chemfiles 0.5.0
 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.0
',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Fortran interface to chemfiles 0.5.0
 documentation" href="index.html" />
    <link rel="prev" title="Usage examples" href="examples.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Fortran interface to chemfiles</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Usage examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fortran interface reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Fortran interface reference</a><ul>
<li><a class="reference internal" href="#naming-conventions-and-call-conventions">Naming conventions and call conventions</a></li>
<li><a class="reference internal" href="#miscellaneous-functions">Miscellaneous functions</a></li>
<li><a class="reference internal" href="#error-and-logging-functions">Error and logging functions</a></li>
<li><a class="reference internal" href="#chfl-trajectory-type"><code class="docutils literal"><span class="pre">chfl_trajectory</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-frame-type"><code class="docutils literal"><span class="pre">chfl_frame</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-cell-type"><code class="docutils literal"><span class="pre">chfl_cell</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-topology-type"><code class="docutils literal"><span class="pre">chfl_topology</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-atom-type"><code class="docutils literal"><span class="pre">chfl_atom</span></code> type</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="examples.html" title="Previous Chapter: Usage examples"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Usage examples</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/reference.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="fortran-interface-reference">
<span id="fortran-api"></span><h1>Fortran interface reference<a class="headerlink" href="#fortran-interface-reference" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal"><span class="pre">chemfiles</span></code> module is built around the 5 main types of chemfiles: <code class="docutils literal"><span class="pre">chfl_trajectory</span></code>,
<code class="docutils literal"><span class="pre">chfl_frame</span></code>, <code class="docutils literal"><span class="pre">chfl_cell</span></code>, <code class="docutils literal"><span class="pre">chfl_topology</span></code>, and <code class="docutils literal"><span class="pre">chfl_atom</span></code>. For more
information about these types, please see the chemfiles <a class="reference external" href="http://chemfiles.readthedocs.org/en/latest/overview.html">overview</a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Atomic indexes in chemfiles starts at 0, not 1. That means that the first atom in
a frame have the index 0, not 1. This should be taken in account when using
chemfiles function. Fortran arrays returned by function still have indexes
starting at 1.</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">indexing</span>
    <span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">real32</span><span class="p">,</span> <span class="n">int64</span>
    <span class="k">use </span><span class="n">chemfiles</span>
    <span class="k">implicit none</span>
<span class="k">    type</span><span class="p">(</span><span class="n">chfl_frame</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">frame</span>
    <span class="k">type</span><span class="p">(</span><span class="n">chfl_atom</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">atom</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">positions</span><span class="p">(:,</span> <span class="p">:)</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">natoms</span>

    <span class="c">! Read the frame here</span>

    <span class="c">! Get the first atom in the frame</span>
    <span class="k">call </span><span class="n">atom</span><span class="p">%</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c">! Get the second atom in the frame</span>
    <span class="c">! call atom%from_frame(frame, 1)</span>

    <span class="k">call </span><span class="n">frame</span><span class="p">%</span><span class="n">poositions</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">natoms</span><span class="p">)</span>
    <span class="c">! position(1, :) now contains the positions of the first atom</span>
<span class="k">end program</span>
</pre></div>
</div>
<p class="last">This may change in future release to make all atomic number starting at 1, which
is more familiar to Fortran developers and would be less confusing.</p>
</div>
<div class="section" id="naming-conventions-and-call-conventions">
<h2>Naming conventions and call conventions<a class="headerlink" href="#naming-conventions-and-call-conventions" title="Permalink to this headline">¶</a></h2>
<p>All the functions and types have the <code class="docutils literal"><span class="pre">chfl_</span></code> prefix. Except for the <code class="docutils literal"><span class="pre">chfl_strerror</span></code>
and <code class="docutils literal"><span class="pre">chfl_last_error</span></code> functions, all the functions take a <code class="docutils literal"><span class="pre">status</span></code> argument,
which will indicate the status of the operation. It should be 0 if everything
was OK, and can be any other number in case of error.</p>
<p>When creating a variable of one of the chemfiles types, the first routine to be
called should be an initialization routine. It can be either the <code class="docutils literal"><span class="pre">init</span></code> routine
for default initialization, or another routine documented as initializing.</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span><span class="k">implicit none</span>
<span class="k">type</span><span class="p">(</span><span class="n">chfl_cell</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<span class="k">type</span><span class="p">(</span><span class="n">chfl_frame</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frame</span>

<span class="k">call </span><span class="n">cell</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="k">call </span><span class="n">frame</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>These initialization function should only be called once. In order to free the
memory asssociated with any chemfiles variable, the <code class="docutils literal"><span class="pre">free</span></code> subroutine should
be called. After a call the the <code class="docutils literal"><span class="pre">free</span></code> subroutine, the <code class="docutils literal"><span class="pre">init</span></code> subroutine
can be called again whithout any memory leak risk. Not initializing chemfiles
variables will lead to segmentations faults.</p>
</div>
<div class="section" id="miscellaneous-functions">
<h2>Miscellaneous functions<a class="headerlink" href="#miscellaneous-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descname">string chfl_version([status])</code></dt>
<dd><p>Get the version of the chemfiles library as a string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="error-and-logging-functions">
<h2>Error and logging functions<a class="headerlink" href="#error-and-logging-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt>
<code class="descname">string chfl_strerror(status)</code></dt>
<dd><p>Get the error message corresponding to an error code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>]</em> :: The status code</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><strong>strerror</strong><em> [</em><em>string</em><em>]</em> :: The error message corresponding to the status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">string chfl_last_error()</code></dt>
<dd><p>Get the last error message.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><strong>strerror</strong><em> [</em><em>string</em><em>]</em> :: The error message corresponding to the status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_loglevel">
<em class="property">subroutine  </em><code class="descname">chfl_loglevel</code><span class="sig-paren">(</span><em>level</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_loglevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current maximal logging level</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>level</strong><em> [</em><em>integer</em><em>,</em><em>kind=CHFL_LOG_LEVEL</em><em>]</em> :: A variable that will contain the logging level</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
<p>The logging level are integers which <code class="docutils literal"><span class="pre">kind</span></code> is the parameter <code class="docutils literal"><span class="pre">CHFL_LOG_LEVEL</span></code>:</p>
<dl class="variable">
<dt>
<code class="descname">integer(CHFL_LOG_LEVEL) :: CHFL_LOG_ERROR</code></dt>
<dd><p>Only log errors</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_LOG_LEVEL) :: CHFL_LOG_WARNING</code></dt>
<dd><p>Log warnings and erors. This is the default.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_LOG_LEVEL) :: CHFL_LOG_INFO</code></dt>
<dd><p>Log infos, warnings and errors</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_LOG_LEVEL) :: CHFL_LOG_DEBUG</code></dt>
<dd><p>Log everything</p>
</dd></dl>

</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_set_loglevel">
<em class="property">subroutine  </em><code class="descname">chfl_set_loglevel</code><span class="sig-paren">(</span><em>level</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_set_loglevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the maximal logging level to <code class="docutils literal"><span class="pre">level</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>level</strong><em> [</em><em>integer</em><em>,</em><em>kind=CHFL_LOG_LEVEL</em><em>]</em> :: The new logging level</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_logfile">
<em class="property">subroutine  </em><code class="descname">chfl_logfile</code><span class="sig-paren">(</span><em>file</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_logfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirect the logs to <code class="docutils literal"><span class="pre">file</span></code>, overwriting the file if it exists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong><em> [</em><em>string</em><em>]</em> :: The path to the log file</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_log_stderr">
<em class="property">subroutine  </em><code class="descname">chfl_log_stderr</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_log_stderr" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirect the logs to the standard error output. This is enabled by default.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_log_stdout">
<em class="property">subroutine  </em><code class="descname">chfl_log_stdout</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_log_stdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirect the logs to the standard output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_log_silent">
<em class="property">subroutine  </em><code class="descname">chfl_log_silent</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_log_silent" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all logging output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_log_callback">
<em class="property">subroutine  </em><code class="descname">chfl_log_callback</code><span class="sig-paren">(</span><em>callback</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_log_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirect all logging to user-provided logging. The <code class="docutils literal"><span class="pre">callback</span></code> subroutine will
be called at each logging operation with the level of the message, and the the
message itself.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>procedure</strong> (<a class="reference internal" href="#f/_/chfl_logging_callback" title="f/_/chfl_logging_callback">chfl_logging_callback</a>) :: The callback procedure</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/chfl_logging_callback">
<em class="property">subroutine  </em><code class="descname">chfl_logging_callback</code><span class="sig-paren">(</span><em>level</em>, <em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/chfl_logging_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the interface for callback functions in the logging system. At every log
event, this function will be called with the level and the message of the log
event.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>level</strong><em> [</em><em>integer</em><em>,</em><em>intent(in)</em><em>]</em> :: The level of the log event</li>
<li><strong>message</strong><em> [</em><em>string</em><em>,</em><em>intent(in)</em><em>]</em> :: The message of the log event</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-trajectory-type">
<h2><code class="docutils literal"><span class="pre">chfl_trajectory</span></code> type<a class="headerlink" href="#chfl-trajectory-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f/_/chfl_trajectory">
<em class="property">type  </em><code class="descname">chfl_trajectory</code><a class="headerlink" href="#f/_/chfl_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapping around a C pointer of type <code class="docutils literal"><span class="pre">CHFL_TRAJECTORY*</span></code>. The following
subroutine are available:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">open</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">with_format</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">read</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">read_step</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">write</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_topology</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_topology_file</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">cell</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">nstep</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">sync</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">close</code><em> [</em><em>subroutine</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The initialization routine are <code class="docutils literal"><span class="pre">open</span></code> and <code class="docutils literal"><span class="pre">with_format</span></code>, and the memory
liberation routine is <code class="docutils literal"><span class="pre">close</span></code>.</p>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/open">
<em class="property">subroutine  </em><code class="descname">open</code><span class="sig-paren">(</span><em>filename</em>, <em>mode</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/open" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a trajectory file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong><em> [</em><em>string</em><em>]</em> :: The path to the trajectory file</li>
<li><strong>mode</strong><em> [</em><em>string</em><em>]</em> :: The opening mode: &#8220;r&#8221; for read, &#8220;w&#8221; for write and  &#8220;a&#8221; for append.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/with_format">
<em class="property">subroutine  </em><code class="descname">with_format</code><span class="sig-paren">(</span><em>filename</em>, <em>mode</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/with_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a trajectory file using a given format to read the file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong><em> [</em><em>string</em><em>]</em> :: The path to the trajectory file</li>
<li><strong>mode</strong><em> [</em><em>string</em><em>]</em> :: The opening mode: &#8220;r&#8221; for read, &#8220;w&#8221; for write and  &#8220;a&#8221; for append.</li>
<li><strong>format</strong><em> [</em><em>string</em><em>]</em> :: The format to use</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/read">
<em class="property">subroutine  </em><code class="descname">read</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the next step of the trajectory into a frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f/_/chfl_frame" title="f/_/chfl_frame"><em>chfl_frame</em></a><em>]</em> :: A frame to fill with the data</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/read_step">
<em class="property">subroutine  </em><code class="descname">read_step</code><span class="sig-paren">(</span><em>step</em>, <em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/read_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a specific step of the trajectory in a frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>step</strong><em> [</em><em>integer</em><em>]</em> :: The step to read</li>
<li><strong>frame</strong><em> [</em><a class="reference internal" href="#f/_/chfl_frame" title="f/_/chfl_frame"><em>chfl_frame</em></a><em>]</em> :: A frame to fill with the data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/write">
<em class="property">subroutine  </em><code class="descname">write</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a frame to the trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f/_/chfl_frame" title="f/_/chfl_frame"><em>chfl_frame</em></a><em>]</em> :: the frame which will be writen to the file</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_topology">
<em class="property">subroutine  </em><code class="descname">set_topology</code><span class="sig-paren">(</span><em>topology</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the topology associated with a trajectory. This topology will be
used when reading and writing the files, replacing any topology in the
frames or files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topology</strong><em> [</em><a class="reference internal" href="#f/_/chfl_topology" title="f/_/chfl_topology"><em>chfl_topology</em></a><em>]</em> :: The new topology to use</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_topology_file">
<em class="property">subroutine  </em><code class="descname">set_topology_file</code><span class="sig-paren">(</span><em>filename</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_topology_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the topology associated with a trajectory by reading the first
frame of <code class="docutils literal"><span class="pre">filename</span></code>; and extracting the topology of this frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong><em> [</em><em>string</em><em>]</em> :: The file to read in order to get the new topology</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/cell">
<em class="property">subroutine  </em><code class="descname">cell</code><span class="sig-paren">(</span><em>cell</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the unit cell associated with a trajectory. This cell will be
used when reading and writing the files, replacing any unit cell in the
frames or files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cell</strong><em> [</em><a class="reference internal" href="#f/_/chfl_cell" title="f/_/chfl_cell"><em>chfl_cell</em></a><em>]</em> :: The new cell to use</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/nsteps">
<em class="property">subroutine  </em><code class="descname">nsteps</code><span class="sig-paren">(</span><em>nsteps</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/nsteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of steps (the number of frames) in a trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nsteps</strong><em> [</em><em>integer</em><em>]</em> :: This will contain the number of steps</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/sync">
<em class="property">subroutine  </em><code class="descname">sync</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush any buffered content to the hard drive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/close">
<em class="property">subroutine  </em><code class="descname">close</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a trajectory file, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-frame-type">
<h2><code class="docutils literal"><span class="pre">chfl_frame</span></code> type<a class="headerlink" href="#chfl-frame-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f/_/chfl_frame">
<em class="property">type  </em><code class="descname">chfl_frame</code><a class="headerlink" href="#f/_/chfl_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapping around a C pointer of type <code class="docutils literal"><span class="pre">CHFL_FRAME*</span></code>. The following
subroutine are available:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">atoms_count</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">resize</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">positions</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">velocities</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">add_velocities</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">has_velocities</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_cell</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_topology</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">step</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_step</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">selection</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/init">
<em class="property">subroutine  </em><code class="descname">init</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/init" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an empty frame with initial capacity of <code class="docutils literal"><span class="pre">natoms</span></code>. It will be
resized by the library as needed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: the size of the wanted frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/atoms_count">
<em class="property">subroutine  </em><code class="descname">atoms_count</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/atoms_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current number of atoms in the frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: the number of atoms in the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/resize">
<em class="property">subroutine  </em><code class="descname">resize</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize the positions and the velocities in frame, to make space for <code class="docutils literal"><span class="pre">natoms</span></code> atoms.
This function may invalidate any pointer to the positions or the velocities if the new
size is bigger than the old one. In all the cases, previous data is conserved. This
function conserve the presence of abscence of velocities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: the new number of atoms in the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/positions">
<em class="property">subroutine  </em><code class="descname">positions</code><span class="sig-paren">(</span><em>data</em>, <em>size</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a pointer to the positions array from a frame. The positions are stored as a <code class="docutils literal"><span class="pre">3</span>
<span class="pre">x</span> <span class="pre">N</span></code> array, this function set a pointer to point to the first element of this array,
and give the value of N in the <code class="docutils literal"><span class="pre">size</span></code> argument. If the frame is resized (by writing
to it, or calling <code class="docutils literal"><span class="pre">chfl_frame%resize</span></code>), the pointer is invalidated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong><em> [</em><em>real</em><em>,</em><em>dimension(:, :), pointer</em><em>]</em> :: A pointer to a float array containing the positions</li>
<li><strong>size</strong><em> [</em><em>integer</em><em>]</em> :: After the call, contains the array size (N).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/velocities">
<em class="property">subroutine  </em><code class="descname">velocities</code><span class="sig-paren">(</span><em>data</em>, <em>size</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a pointer to the velocities array from a frame. The velocities are stored as a <code class="docutils literal"><span class="pre">3</span>
<span class="pre">x</span> <span class="pre">N</span></code> array, this function set a pointer to point to the first element of this array,
and give the value of N in the <code class="docutils literal"><span class="pre">size</span></code> argument. If the frame is resized (by writing
to it, or calling <code class="docutils literal"><span class="pre">chfl_frame%resize</span></code>), the pointer is invalidated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong><em> [</em><em>real</em><em>,</em><em>dimension(:, :), pointer</em><em>]</em> :: A pointer to a float array containing the velocities</li>
<li><strong>size</strong><em> [</em><em>integer</em><em>]</em> :: The array size (N).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/add_velocities">
<em class="property">subroutine  </em><code class="descname">add_velocities</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/add_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Add velocity storage to this frame. The storage is initialized with the result of
<code class="docutils literal"><span class="pre">chfl_frame%atoms_count</span></code> as number of atoms. If the frame already have velocities,
this does nothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/has_velocities">
<em class="property">subroutine  </em><code class="descname">has_velocities</code><span class="sig-paren">(</span><em>has_vel</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/has_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a frame has velocity information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>has_vel</strong><em> [</em><em>logical</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the frame has velocities, <code class="docutils literal"><span class="pre">.false.</span></code> otherwise.</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_cell">
<em class="property">subroutine  </em><code class="descname">set_cell</code><span class="sig-paren">(</span><em>cell</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the UnitCell of a Frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cell</strong><em> [</em><a class="reference internal" href="#f/_/chfl_cell" title="f/_/chfl_cell"><em>chfl_cell</em></a><em>]</em> :: The new unit cell</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">set_topology</code><span class="sig-paren">(</span><em>topology</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Set the Topology of a Frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topology</strong><em> [</em><a class="reference internal" href="#f/_/chfl_topology" title="f/_/chfl_topology"><em>chfl_topology</em></a><em>]</em> :: The new topology</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/step">
<em class="property">subroutine  </em><code class="descname">step</code><span class="sig-paren">(</span><em>step</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/step" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Frame step, i.e. the frame number in the trajectory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>step</strong><em> [</em><em>integer</em><em>]</em> :: This will contains the step number</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_step">
<em class="property">subroutine  </em><code class="descname">set_step</code><span class="sig-paren">(</span><em>step</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the Frame step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>step</strong><em> [</em><em>integer</em><em>]</em> :: The new frame step</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/guess_topology">
<em class="property">subroutine  </em><code class="descname">guess_topology</code><span class="sig-paren">(</span><em>bonds</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/guess_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to guess the bonds, angles and dihedrals in the system. If <code class="docutils literal"><span class="pre">bonds</span></code>
is <code class="docutils literal"><span class="pre">.true.</span></code>, guess everything; else only guess the angles and dihedrals from
the bond list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bonds</strong><em> [</em><em>logical</em><em>]</em> :: Should we recompute the bonds from the positions or not ?</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/selection">
<em class="property">subroutine  </em><code class="descname">selection</code><span class="sig-paren">(</span><em>selection</em>, <em>matched</em>, <em>natoms</em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms in a frame, from a specific selection string.</p>
<p>This function select atoms in a frame matching a selection string. For example,
<code class="docutils literal"><span class="pre">&quot;name</span> <span class="pre">H</span> <span class="pre">and</span> <span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">4&quot;</span></code> will select all the atoms with name <code class="docutils literal"><span class="pre">&quot;H&quot;</span></code> and <code class="docutils literal"><span class="pre">x</span></code>
coordinate less than 4. See the C++ documentation for the full selection language.</p>
<p>Results of this function are used to fill the <code class="docutils literal"><span class="pre">matched</span></code> pre-allocated array
containing <code class="docutils literal"><span class="pre">natoms</span></code> logical, where <code class="docutils literal"><span class="pre">natoms</span></code> is the number of atoms in the frame.
The array will contain <code class="docutils literal"><span class="pre">.true.</span></code> at position <code class="docutils literal"><span class="pre">i</span></code> if the atom at position <code class="docutils literal"><span class="pre">i</span></code>
matches the selection string, and false otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: The selection string</li>
<li><strong>matched</strong><em> [</em><em>logical</em><em>,</em><em>dimension(:)</em><em>]</em> :: A pre-allocated array of size <code class="docutils literal"><span class="pre">natoms</span></code></li>
<li><strong>natoms</strong> :: The size of the <code class="docutils literal"><span class="pre">matched</span></code> array. This must be the same size as <code class="docutils literal"><span class="pre">chfl_frame%atoms_count</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/free">
<em class="property">subroutine  </em><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/free" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy a frame, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-cell-type">
<h2><code class="docutils literal"><span class="pre">chfl_cell</span></code> type<a class="headerlink" href="#chfl-cell-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f/_/chfl_cell">
<em class="property">type  </em><code class="descname">chfl_cell</code><a class="headerlink" href="#f/_/chfl_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapping around a C pointer of type <code class="docutils literal"><span class="pre">CHFL_CELL*</span></code>. The following
subroutine are available:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">from_frame</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lengths</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_lengths</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">angles</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_angles</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">matrix</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">type</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_type</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">periodicity</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_periodicity</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The initialization routine are <code class="docutils literal"><span class="pre">init</span></code> and <code class="docutils literal"><span class="pre">from_frame</span></code>.</p>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">init</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Create an <code class="docutils literal"><span class="pre">chfl_cell</span></code> from the three lenghts and the three angles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong><em> [</em><em>real</em><em>]</em> :: the a cell length, in angstroms</li>
<li><strong>b</strong><em> [</em><em>real</em><em>]</em> :: the b cell length, in angstroms</li>
<li><strong>c</strong><em> [</em><em>real</em><em>]</em> :: the c cell length, in angstroms</li>
<li><strong>alpha</strong><em> [</em><em>real</em><em>]</em> :: the alpha angles, in degrees</li>
<li><strong>beta</strong><em> [</em><em>real</em><em>]</em> :: the beta angles, in degrees</li>
<li><strong>gamma</strong><em> [</em><em>real</em><em>]</em> :: the gamma angles, in degrees</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/from_frame_init_">
<em class="property">subroutine  </em><code class="descname">from_frame_init_</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/from_frame_init_" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a copy of the <code class="docutils literal"><span class="pre">chfl_cell</span></code> of a frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f/_/chfl_frame" title="f/_/chfl_frame"><em>chfl_frame</em></a><em>]</em> :: the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/lengths">
<em class="property">subroutine  </em><code class="descname">lengths</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cell lenghts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong><em> [</em><em>real</em><em>]</em> :: the a cell length, in angstroms</li>
<li><strong>b</strong><em> [</em><em>real</em><em>]</em> :: the b cell length, in angstroms</li>
<li><strong>c</strong><em> [</em><em>real</em><em>]</em> :: the c cell length, in angstroms</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_lengths">
<em class="property">subroutine  </em><code class="descname">set_lengths</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the unit cell lenghts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong><em> [</em><em>real</em><em>]</em> :: the new a cell length, in angstroms</li>
<li><strong>b</strong><em> [</em><em>real</em><em>]</em> :: the new b cell length, in angstroms</li>
<li><strong>c</strong><em> [</em><em>real</em><em>]</em> :: the new c cell length, in angstroms</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/angles">
<em class="property">subroutine  </em><code class="descname">angles</code><span class="sig-paren">(</span><em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cell angles, in degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alpha</strong><em> [</em><em>real</em><em>]</em> :: the alpha angles, in degrees</li>
<li><strong>beta</strong><em> [</em><em>real</em><em>]</em> :: the beta angles, in degrees</li>
<li><strong>gamma</strong><em> [</em><em>real</em><em>]</em> :: the gamma angles, in degrees</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_angles">
<em class="property">subroutine  </em><code class="descname">set_angles</code><span class="sig-paren">(</span><em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the cell angles, in degrees</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alpha</strong><em> [</em><em>real</em><em>]</em> :: the new alpha angles, in degrees</li>
<li><strong>beta</strong><em> [</em><em>real</em><em>]</em> :: the new beta angles, in degrees</li>
<li><strong>gamma</strong><em> [</em><em>real</em><em>]</em> :: the new gamma angles, in degrees</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/matrix">
<em class="property">subroutine  </em><code class="descname">matrix</code><span class="sig-paren">(</span><em>matrix</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unit cell matricial representation, i.e. the representation of the three
base vectors arranged as:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="p">|</span> a_x b_x c_x <span class="p">|</span>
<span class="p">|</span>  <span class="m">0</span>  b_y c_y <span class="p">|</span>
<span class="p">|</span>  <span class="m">0</span>   <span class="m">0</span>  c_z <span class="p">|</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong><em> [</em><em>real</em><em>,</em><em>dimension(3, 3)</em><em>]</em> :: the matrix to fill.</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/type">
<em class="property">subroutine  </em><code class="descname">type</code><span class="sig-paren">(</span><em>type</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/type" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cell type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong><em> [</em><em>integer</em><em>,</em><em>kind=CHFL_CELL_TYPES</em><em>]</em> :: the type of the cell</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
<p>The cell types are integers which <code class="docutils literal"><span class="pre">kind</span></code> is the parameter <code class="docutils literal"><span class="pre">CHFL_CELL_TYPES</span></code>:</p>
<dl class="variable">
<dt>
<code class="descname">integer(CHFL_CELL_TYPES) :: CHFL_CELL_ORTHOROMBIC</code></dt>
<dd><p>The three angles are 90°</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_CELL_TYPES) :: CHFL_CELL_TRICLINIC</code></dt>
<dd><p>The three angles may not be 90°</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_CELL_TYPES) :: CHFL_CELL_INFINITE</code></dt>
<dd><p>Cell type when there is no periodic boundary conditions</p>
</dd></dl>

</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_type">
<em class="property">subroutine  </em><code class="descname">set_type</code><span class="sig-paren">(</span><em>type</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the cell type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong><em> [</em><em>integer</em><em>,</em><em>kind=CHFL_CELL_TYPES</em><em>]</em> :: the new type of the cell</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Destroy an unit cell, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-topology-type">
<h2><code class="docutils literal"><span class="pre">chfl_topology</span></code> type<a class="headerlink" href="#chfl-topology-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f/_/chfl_topology">
<em class="property">type  </em><code class="descname">chfl_topology</code><a class="headerlink" href="#f/_/chfl_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapping around a C pointer of type <code class="docutils literal"><span class="pre">CHFL_TOPOLOGY*</span></code>. The following
subroutine are available:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">from_frame</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">atoms_count</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">guess</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">append</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">remove</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">isbond</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">isangle</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">isdihedral</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">bonds_count</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">angles_count</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dihedrals_count</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">bonds</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">angles</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dihedrals</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">add_bond</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">remove_bond</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The initialization routine are <code class="docutils literal"><span class="pre">init</span></code> and <code class="docutils literal"><span class="pre">from_frame</span></code>.</p>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">init</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Create a new empty topology</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/from_frame">
<em class="property">subroutine  </em><code class="descname">from_frame</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/from_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the topology from a frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f/_/chfl_frame" title="f/_/chfl_frame"><em>chfl_frame</em></a><em>]</em> :: The frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">atoms_count</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Get the current number of atoms in the topology.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: Will contain the number of atoms in the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/append">
<em class="property">subroutine  </em><code class="descname">append</code><span class="sig-paren">(</span><em>atom</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/append" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an atom at the end of a topology.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom</strong><em> [</em><a class="reference internal" href="#f/_/chfl_atom" title="f/_/chfl_atom"><em>chfl_atom</em></a><em>]</em> :: The atom to be added</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/remove">
<em class="property">subroutine  </em><code class="descname">remove</code><span class="sig-paren">(</span><em>i</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an atom from a topology by index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/isbond">
<em class="property">subroutine  </em><code class="descname">isbond</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/isbond" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell if the atoms <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code> are bonded together</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the second atom</li>
<li><strong>result</strong><em> [</em><em>logical</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the atoms are bonded, <code class="docutils literal"><span class="pre">.false.</span></code> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/isangle">
<em class="property">subroutine  </em><code class="descname">isangle</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/isangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell if the atoms <code class="docutils literal"><span class="pre">i</span></code>, <code class="docutils literal"><span class="pre">j</span></code> and <code class="docutils literal"><span class="pre">k</span></code> constitues an angle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the second atom</li>
<li><strong>k</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the third atom</li>
<li><strong>result</strong><em> [</em><em>logical</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the atoms constitues an angle, <code class="docutils literal"><span class="pre">.false.</span></code> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/isdihedral">
<em class="property">subroutine  </em><code class="descname">isdihedral</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>m</em>, <em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/isdihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell if the atoms <code class="docutils literal"><span class="pre">i</span></code>, <code class="docutils literal"><span class="pre">j</span></code>, <code class="docutils literal"><span class="pre">k</span></code> and <code class="docutils literal"><span class="pre">m</span></code> constitues a dihedral angle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the second atom</li>
<li><strong>k</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the third atom</li>
<li><strong>m</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the fourth atom</li>
<li><strong>result</strong><em> [</em><em>logical</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the atoms constitues a dihedral angle, <code class="docutils literal"><span class="pre">.false.</span></code> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/bonds_count">
<em class="property">subroutine  </em><code class="descname">bonds_count</code><span class="sig-paren">(</span><em>nbonds</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/bonds_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of bonds in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nbonds</strong><em> [</em><em>integer</em><em>]</em> :: After the call, contains the number of bond</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/angles_count">
<em class="property">subroutine  </em><code class="descname">angles_count</code><span class="sig-paren">(</span><em>nangles</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/angles_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of angles in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nangles</strong><em> [</em><em>integer</em><em>]</em> :: After the call, contains the number of angles</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/dihedrals_count">
<em class="property">subroutine  </em><code class="descname">dihedrals_count</code><span class="sig-paren">(</span><em>ndihedrals</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/dihedrals_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dihedral angles in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ndihedrals</strong><em> [</em><em>integer</em><em>]</em> :: After the call, contains the number of dihedral angles</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/bonds">
<em class="property">subroutine  </em><code class="descname">bonds</code><span class="sig-paren">(</span><em>data</em>, <em>nbonds</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the bonds in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong><em> [</em><em>integer</em><em>,</em><em>dimension(2, nbonds)</em><em>]</em> :: A 2x <code class="docutils literal"><span class="pre">nbonds</span></code> array to be
filled with the bonds in the system</li>
<li><strong>nbonds</strong><em> [</em><em>integer</em><em>]</em> :: The size of the array. This should equal the value
given by the <code class="docutils literal"><span class="pre">chfl_topology%bonds_count</span></code> function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">angles</code><span class="sig-paren">(</span><em>data</em>, <em>nangles</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Get the angles in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong><em> [</em><em>integer</em><em>,</em><em>dimension(3, nangles)</em><em>]</em> :: A 3x <code class="docutils literal"><span class="pre">nangles</span></code> array to be
filled with the angles in the system</li>
<li><strong>nangles</strong><em> [</em><em>integer</em><em>]</em> :: The size of the array. This should equal the
value give by the <code class="docutils literal"><span class="pre">chfl_topology%angles_count</span></code> function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/dihedrals">
<em class="property">subroutine  </em><code class="descname">dihedrals</code><span class="sig-paren">(</span><em>data</em>, <em>ndihedrals</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dihedral angles in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong><em> [</em><em>integer</em><em>,</em><em>dimension(4, ndihedrals)</em><em>]</em> :: A 4x <code class="docutils literal"><span class="pre">ndihedrals</span></code> array
to be filled with the dihedral angles in the system</li>
<li><strong>ndihedrals</strong><em> [</em><em>integer</em><em>]</em> :: The size of the array. This should equal the
value give by the <code class="docutils literal"><span class="pre">chfl_topology%dihedrals_count</span></code> function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/add_bond">
<em class="property">subroutine  </em><code class="descname">add_bond</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bond between the atoms <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code> in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the second atom</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/remove_bond">
<em class="property">subroutine  </em><code class="descname">remove_bond</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/remove_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any existing bond between the atoms <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code> in the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the second atom</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Destroy a topology, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-atom-type">
<h2><code class="docutils literal"><span class="pre">chfl_atom</span></code> type<a class="headerlink" href="#chfl-atom-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f/_/chfl_atom">
<em class="property">type  </em><code class="descname">chfl_atom</code><a class="headerlink" href="#f/_/chfl_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapping around a C pointer of type <code class="docutils literal"><span class="pre">CHFL_ATOM*</span></code>. The following
subroutine are available:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">from_frame</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">from_topology</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">mass</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_mass</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">charge</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_charge</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">name</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">set_name</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">full_name</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vdw_radius</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">covalent_radius</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">atomic_number</code><em> [</em><em>subroutine</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The initialization routine are <code class="docutils literal"><span class="pre">init</span></code>, <code class="docutils literal"><span class="pre">from_frame</span></code> and <code class="docutils literal"><span class="pre">from_topology</span></code>.</p>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">init</code><span class="sig-paren">(</span><em>name</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Create an atom from an atomic name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong><em> [</em><em>string</em><em>]</em> :: The new atom name</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">from_frame</code><span class="sig-paren">(</span><em>frame</em>, <em>idx</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Get a specific atom from a frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>frame</strong><em> [</em><a class="reference internal" href="#f/_/chfl_frame" title="f/_/chfl_frame"><em>chfl_frame</em></a><em>]</em> :: The frame</li>
<li><strong>idx</strong><em> [</em><em>integer</em><em>]</em> :: The atom index in the frame</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/from_topology">
<em class="property">subroutine  </em><code class="descname">from_topology</code><span class="sig-paren">(</span><em>topology</em>, <em>idx</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/from_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a specific atom from a topology</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>topology</strong><em> [</em><a class="reference internal" href="#f/_/chfl_topology" title="f/_/chfl_topology"><em>chfl_topology</em></a><em>]</em> :: The topology</li>
<li><strong>idx</strong><em> [</em><em>integer</em><em>]</em> :: The atom index in the topology</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/mass">
<em class="property">subroutine  </em><code class="descname">mass</code><span class="sig-paren">(</span><em>mass</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mass of an atom, in atomic mass units</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mass</strong><em> [</em><em>real</em><em>]</em> :: The atom mass</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_mass">
<em class="property">subroutine  </em><code class="descname">set_mass</code><span class="sig-paren">(</span><em>mass</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the mass of an atom, in atomic mass units</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mass</strong><em> [</em><em>real</em><em>]</em> :: The new atom mass</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/charge">
<em class="property">subroutine  </em><code class="descname">charge</code><span class="sig-paren">(</span><em>charge</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the charge of an atom, in number of the electron charge e</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>charge</strong><em> [</em><em>real</em><em>]</em> :: The atom charge</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_charge">
<em class="property">subroutine  </em><code class="descname">set_charge</code><span class="sig-paren">(</span><em>charge</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the charge of an atom, in number of the electron charge e</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>charge</strong><em> [</em><em>real</em><em>]</em> :: The new atom charge</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/name">
<em class="property">subroutine  </em><code class="descname">name</code><span class="sig-paren">(</span><em>name</em>, <em>buffsize</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of an atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong><em> [</em><em>string</em><em>]</em> :: A string buffer to be filled with the name</li>
<li><strong>buffsize</strong> :: The lenght of the string <code class="docutils literal"><span class="pre">name</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/set_name">
<em class="property">subroutine  </em><code class="descname">set_name</code><span class="sig-paren">(</span><em>name</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of an atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong><em> [</em><em>string</em><em>]</em> :: A string containing the new name</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/full_name">
<em class="property">subroutine  </em><code class="descname">full_name</code><span class="sig-paren">(</span><em>name</em>, <em>buffsize</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/full_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to get the full name of an atom from the short name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong><em> [</em><em>string</em><em>]</em> :: A string buffer to be filled with the name</li>
<li><strong>buffsize</strong> :: The lenght of the string <code class="docutils literal"><span class="pre">name</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/vdw_radius">
<em class="property">subroutine  </em><code class="descname">vdw_radius</code><span class="sig-paren">(</span><em>radius</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/vdw_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to get the Van der Waals radius of an atom from the short name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>radius</strong><em> [</em><em>real</em><em>]</em> :: The Van der Waals radius of the atom or -1 if no value could be found.</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/covalent_radius">
<em class="property">subroutine  </em><code class="descname">covalent_radius</code><span class="sig-paren">(</span><em>radius</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/covalent_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to get the covalent radius of an atom from the short name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>radius</strong><em> [</em><em>real</em><em>]</em> :: The covalent radius of the atom or -1 if no value could be found.</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/_/atomic_number">
<em class="property">subroutine  </em><code class="descname">atomic_number</code><span class="sig-paren">(</span><em>number</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/_/atomic_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to get the atomic number of an atom from the short name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>number</strong><em> [</em><em>integer</em><em>]</em> :: The atomic number, or -1 if no value could be found.</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">type</code><span class="sig-paren">(</span><em>type</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Get the atom type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong><em> [</em><em>integer</em><em>,</em><em>kind=CHFL_ATOM_TYPES</em><em>]</em> :: the type of the atom</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
<p>The atom types are integers which <code class="docutils literal"><span class="pre">kind</span></code> is the parameter <code class="docutils literal"><span class="pre">CHFL_ATOM_TYPES</span></code>:</p>
<dl class="variable">
<dt>
<code class="descname">integer(CHFL_ATOM_TYPES) :: CHFL_ATOM_ELEMENT</code></dt>
<dd><p>Element from the periodic table of elements.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_ATOM_TYPES) :: CHFL_ATOM_COARSE_GRAINED</code></dt>
<dd><p>Coarse-grained atom are composed of more than one element: CH3 groups,
amino-acids are coarse-grained atoms.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_ATOM_TYPES) :: CHFL_ATOM_DUMMY</code></dt>
<dd><p>Dummy site, with no physical reality.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(CHFL_ATOM_TYPES) :: CHFL_ATOM_UNDEFINED</code></dt>
<dd><p>Undefined atom type.</p>
</dd></dl>

</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">set_type</code><span class="sig-paren">(</span><em>type</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Set the atom type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong><em> [</em><em>integer</em><em>,</em><em>kind=CHFL_ATOM_TYPES</em><em>]</em> :: the new type of the atom</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt>
<em class="property">subroutine  </em><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Destroy an atom, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional</em><em>]</em> :: The status code</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Guillaume Fraux — MPLv2 licence.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>